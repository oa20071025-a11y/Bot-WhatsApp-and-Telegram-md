const { Telegraf } = require('telegraf');
const { startWA } = require('./whatsapp');

// ุงูุชููู ุงูุฎุงุต ุจู
const bot = new Telegraf("8595696537:AAEZg1gDcu-GqTVMPPYlAPwMMRVGkp4senY");

bot.start(ctx => {
  ctx.reply("๐ ุฃููุงู ุจูู ูู ุจูุช ELMASRY ๐\n\n๐ฒ ุงุจุนุช ุฑููู ูุน ููุฏ ุงูุฏููุฉ ุนุดุงู ุฃุจุนุชูู ููุฏ ุงูุฑุจุท.\n\nูุซุงู: +201234567890");
});

bot.on('text', async ctx => {
  const phone = ctx.message.text.trim();

  if (!phone.startsWith('+')) {
    return ctx.reply("โ ุฎุทุฃ: ูุงุฒู ุงูุฑูู ูุจุฏุฃ ุจุนูุงูุฉ (+) ูููุฏ ุงูุฏููุฉ.");
  }

  const waiting = await ctx.reply("โณ ุฌุงุฑู ุงูุงุชุตุงู ุจุฎูุงุฏู ูุงุชุณุงุจ ูุชูููุฏ ุงูููุฏ...");

  try {
    const code = await startWA(ctx.from.id, phone);
    
    await ctx.reply(`โ ุชู ุชูููุฏ ููุฏ ุงูุฑุจุท ุจูุฌุงุญ!\n\n๐ ุงูููุฏ: ${code}\n\n๐ฒ ุงูุฎุทูุงุช:\n1๏ธโฃ ุงูุชุญ ูุงุชุณุงุจ > ุงูุฃุฌูุฒุฉ ุงููุฑุชุจุทุฉ.\n2๏ธโฃ ุงุฎุชุงุฑ "ุฑุจุท ุฌูุงุฒ" ุซู "ุงูุฑุจุท ุจุฑูู ุงููุงุชู".\n3๏ธโฃ ุงูุชุจ ุงูููุฏ ุงููู ููู ุฏู.`);
  } catch (err) {
    ctx.reply("โ ูุดู ุทูุจ ุงูููุฏ. ุชุฃูุฏ ุฃู ุงูุฑูู ุตุญูุญ ูุนููู ูุงุชุณุงุจ ูุดุท.");
  }
});

bot.launch();
